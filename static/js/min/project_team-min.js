$(document).ready(function(){function e(e){e.preventDefault();var a=$(this),t=a.data("user-id");$.post(window.addWorkerURL,{user_id:t}).done(function(e){e.status===!0?(i.val("").trigger("input"),f.magnificPopup("close"),a.parent().clone().insertBefore(h).find(".close").show(),a.parent().hide(),$(".tipsy ").remove()):console.error(e)})}function a(e){e.preventDefault();var a=$(this).attr("disabled",!0),t=a.siblings("a.worker").data("user-id");$.post(window.deleteWorkerURL,{user_id:t}).done(function(e){e.status===!0?a.parent().fadeOut(function(){$(this).remove(),$(".tipsy ").remove()}):(console.error(e),a.attr("disabled",!1))})}function t(){var e,a,t,n,r,i,c,l,g,p,f=d.val(),h=s.val(),v=u.val(),k=w.find("a.worker"),y=$.map(k,function(e,a){return $(e).data("user-id")}),A=m.val().toLowerCase(),b=new RegExp(A);p=o.filter(function(o,d){return e=$(d).find(".nom").text().toLowerCase(),a=b.test(e),t=-1===$.inArray($(d).data("user-id"),y),i=$(d).data("source-langs-ids").toString().split(","),c=$(d).data("target-langs-ids").toString().split(","),n=-1!==$.inArray(f,i),r=-1!==$.inArray(h,c),l=$(d).data("domains-ids").toString().split(","),g=""===v||-1!==$.inArray(v,l),a&&t&&n&&r&&g}),o.not(p).parent().hide(),p.parent().show()}function n(){var e,a,t,n,r,o,i,d,s,u=c.val(),m=l.val(),f=g.val(),h=w.find("a.worker"),v=p.val().toLowerCase(),k=new RegExp(v);s=h.filter(function(s,c){return e=$(c).find(".nom").text().toLowerCase(),a=k.test(e),r=$(c).data("source-langs-ids").toString().split(","),o=$(c).data("target-langs-ids").toString().split(","),t=-1!==$.inArray(u,r),n=-1!==$.inArray(m,o),i=$(c).data("domains-ids").toString().split(","),d=""===f||-1!==$.inArray(f,i),a&&t&&n&&d}),h.not(s).parent().hide(),s.parent().show()}var r=$("table#file-list"),o=$("#addWorker").find("a.worker"),i=$("#search-added-workers"),d=$("#source-language"),s=$("#target-language"),u=$("#domain"),c=$("#team-source-language"),l=$("#team-target-language"),g=$("#team-domain"),m=$("#search-available-workers"),p=$("#team-search"),f=$(".mfp-wrap"),w=$("#added-workers-list"),h=$(".add");n(),$(document).on("click","#addWorker a.worker",e),$(document).on("click","#added-workers-list .close",a),$(document).on("input","#search-available-workers",t),$(document).on("click","#add-worker",t),$(document).on("change","#source-language",t),$(document).on("change","#target-language",t),$(document).on("change","#target-language",t),$(document).on("change","#domain",t),$(document).on("input","#team-search",n),$(document).on("change","#team-source-language",n),$(document).on("change","#team-target-language",n),$(document).on("change","#team-domain",n)});